{
  "openapi": "3.0.3",
  "info": {
    "title": "Detail Public API",
    "version": "1.0.0",
    "description": "Public API for programmatic access to Detail bug findings."
  },
  "servers": [
    {
      "url": "http://localhost:4317",
      "description": "Production"
    }
  ],
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "description": "API key authentication. Keys are prefixed with \"dtl_live_\" or \"dtl_test_\"."
      }
    },
    "schemas": {
      "Schema0": {
        "type": "string",
        "enum": [
          "resolved",
          "dismissed",
          "pending"
        ]
      },
      "Schema1": {
        "type": "string",
        "enum": [
          "not_a_bug",
          "wont_fix",
          "duplicate",
          "other"
        ]
      },
      "Schema2": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "const": "INTERNAL_ERROR"
          },
          "message": {
            "type": "string"
          },
          "statusCode": {
            "type": "integer",
            "const": 500
          }
        },
        "required": [
          "type",
          "message",
          "statusCode"
        ],
        "additionalProperties": false
      },
      "Schema3": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "const": "DETAIL_AUTHENTICATION_ERROR"
          },
          "message": {
            "type": "string"
          },
          "statusCode": {
            "type": "integer",
            "const": 401
          }
        },
        "required": [
          "type",
          "message",
          "statusCode"
        ],
        "additionalProperties": false
      },
      "Schema4": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "const": "NOT_FOUND"
          },
          "message": {
            "type": "string"
          },
          "resource": {
            "type": "string"
          },
          "statusCode": {
            "type": "integer",
            "const": 404
          }
        },
        "required": [
          "type",
          "message",
          "statusCode"
        ],
        "additionalProperties": false
      },
      "Schema5": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "const": "AUTHORIZATION_ERROR"
          },
          "message": {
            "type": "string"
          },
          "requiredRole": {
            "type": "string"
          },
          "statusCode": {
            "type": "integer",
            "const": 403
          }
        },
        "required": [
          "type",
          "message",
          "statusCode"
        ],
        "additionalProperties": false
      },
      "Schema6": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "state": {
            "$ref": "#/components/schemas/Schema0"
          },
          "createdAt": {
            "type": "integer",
            "minimum": -9007199254740991,
            "maximum": 9007199254740991
          },
          "dismissalReason": {
            "$ref": "#/components/schemas/Schema1"
          },
          "notes": {
            "type": "string"
          }
        },
        "required": [
          "id",
          "state",
          "createdAt"
        ],
        "additionalProperties": false
      },
      "Schema7": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "summary": {
            "type": "string"
          },
          "filePath": {
            "type": "string"
          },
          "createdAt": {
            "type": "integer",
            "minimum": -9007199254740991,
            "maximum": 9007199254740991
          },
          "review": {
            "$ref": "#/components/schemas/Schema6"
          },
          "repoId": {
            "type": "string"
          },
          "commitSha": {
            "type": "string"
          },
          "isSecurityVulnerability": {
            "type": "boolean"
          }
        },
        "required": [
          "id",
          "title",
          "summary",
          "createdAt",
          "repoId"
        ],
        "additionalProperties": false
      }
    }
  },
  "paths": {
    "/public/v1/bugs": {
      "get": {
        "operationId": "listPublicBugs",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "repo_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Schema0"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "default": 50,
              "type": "integer",
              "minimum": 1,
              "maximum": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "default": 0,
              "type": "integer",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "bugs": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Schema7"
                      }
                    },
                    "total": {
                      "type": "integer",
                      "minimum": -9007199254740991,
                      "maximum": 9007199254740991
                    }
                  },
                  "required": [
                    "bugs",
                    "total"
                  ],
                  "additionalProperties": false
                }
              }
            }
          },
          "default": {
            "description": "Error",
            "content": {
              "application/json": {
                "schema": {
                  "anyOf": [
                    {
                      "$ref": "#/components/schemas/Schema3"
                    },
                    {
                      "$ref": "#/components/schemas/Schema5"
                    },
                    {
                      "$ref": "#/components/schemas/Schema2"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/public/v1/bugs/{bug_id}": {
      "get": {
        "operationId": "getPublicBug",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "bug_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Schema7"
                }
              }
            }
          },
          "default": {
            "description": "Error",
            "content": {
              "application/json": {
                "schema": {
                  "anyOf": [
                    {
                      "$ref": "#/components/schemas/Schema3"
                    },
                    {
                      "$ref": "#/components/schemas/Schema5"
                    },
                    {
                      "$ref": "#/components/schemas/Schema4"
                    },
                    {
                      "$ref": "#/components/schemas/Schema2"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/public/v1/bugs/{bug_id}/review": {
      "post": {
        "operationId": "createPublicBugReview",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "bug_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "state": {
                    "$ref": "#/components/schemas/Schema0"
                  },
                  "dismissalReason": {
                    "$ref": "#/components/schemas/Schema1"
                  },
                  "notes": {
                    "type": "string"
                  }
                },
                "required": [
                  "state"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Schema6"
                }
              }
            }
          },
          "default": {
            "description": "Error",
            "content": {
              "application/json": {
                "schema": {
                  "anyOf": [
                    {
                      "$ref": "#/components/schemas/Schema3"
                    },
                    {
                      "$ref": "#/components/schemas/Schema5"
                    },
                    {
                      "$ref": "#/components/schemas/Schema4"
                    },
                    {
                      "$ref": "#/components/schemas/Schema2"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/public/v1/user": {
      "get": {
        "operationId": "getPublicUser",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "email": {
                      "type": "string"
                    },
                    "orgs": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "id",
                          "name"
                        ],
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "email",
                    "orgs"
                  ],
                  "additionalProperties": false
                }
              }
            }
          },
          "default": {
            "description": "Error",
            "content": {
              "application/json": {
                "schema": {
                  "anyOf": [
                    {
                      "$ref": "#/components/schemas/Schema3"
                    },
                    {
                      "$ref": "#/components/schemas/Schema2"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/public/v1/repos": {
      "get": {
        "operationId": "listPublicRepos",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "default": 50,
              "type": "integer",
              "minimum": 1,
              "maximum": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "default": 0,
              "type": "integer",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "repos": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "ownerName": {
                            "type": "string"
                          },
                          "fullName": {
                            "type": "string"
                          },
                          "visibility": {
                            "type": "string"
                          },
                          "primaryBranch": {
                            "type": "string"
                          },
                          "orgId": {
                            "type": "string"
                          },
                          "orgName": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "ownerName",
                          "fullName",
                          "visibility",
                          "primaryBranch",
                          "orgId",
                          "orgName"
                        ],
                        "additionalProperties": false
                      }
                    },
                    "total": {
                      "type": "integer",
                      "minimum": -9007199254740991,
                      "maximum": 9007199254740991
                    }
                  },
                  "required": [
                    "repos",
                    "total"
                  ],
                  "additionalProperties": false
                }
              }
            }
          },
          "default": {
            "description": "Error",
            "content": {
              "application/json": {
                "schema": {
                  "anyOf": [
                    {
                      "$ref": "#/components/schemas/Schema3"
                    },
                    {
                      "$ref": "#/components/schemas/Schema2"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    }
  }
}